---
title: GuestBook
description: A simple guestbook using Google Sheets as a database.
image: https://milind.live/og/guestbook.png
---

import { GoogleSpreadsheet } from "google-spreadsheet"
import { JWT } from "google-auth-library"

export async function getServerSideProps() {
  try {
    const serviceAccountAuth = new JWT({
      email: process.env.GOOGLE_SHEETS_CLIENT_EMAIL,
      key: process.env.GOOGLE_SHEETS_PRIVATE_KEY,
      scopes: ["https://www.googleapis.com/auth/spreadsheets"],
    })
    const doc = new GoogleSpreadsheet(process.env.SHEET_ID, serviceAccountAuth)
    await doc.loadInfo()
    console.log(doc.title)
    const sheet = doc.sheetsByIndex[1]
    console.log(sheet.title)
    console.log(sheet.rowCount)
  } catch (err) {
    console.log(err)
  }
  return {
    props: {},
  }
}

export default function GuestBook() {
  return (
    <div>
      <h1>GuestBook</h1>
    </div>
  )
}
